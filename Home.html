<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>e-Serbisyong Tañong</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="icon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        /* Consistent shadow tokens */
        :root{
            /* stronger, more visible shadows */
            --shadow-xs: 0 4px 12px rgba(31,38,135,0.07);
            --shadow-sm: 0 8px 26px rgba(31,38,135,0.09);
            --shadow-md: 0 14px 36px rgba(31,38,135,0.12);
            --shadow-lg: 0 22px 60px rgba(31,38,135,0.16);
        }

        /* Navbar — subtle elevated card */
        nav {
            background: rgba(255,255,255,0.96) !important; /* override bg-white/90 */
            box-shadow: var(--shadow-md);
            z-index: 60; /* ensure it's above other layers */
        }

        /* Search input — slight inset shadow for depth */
        #serviceSearch {
            box-shadow: var(--shadow-xs);
        }

        /* Services list container — keep a soft card shadow */
        #servicesList {
            box-shadow: var(--shadow-sm);
        }

        /* Service category cards (Infrastructure / Social / General / Others)
           keep consistent elevation and add hover lift */
        .flex.flex-row > .flex.flex-col.items-center.bg-white.rounded-xl {
            box-shadow: var(--shadow-sm);
            transition: box-shadow .18s ease, transform .18s ease;
        }
        .flex.flex-row > .flex.flex-col.items-center.bg-white.rounded-xl:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        /* Dynamic service buttons in the services list */
        #servicesList button {
            box-shadow: var(--shadow-xs);
            transition: box-shadow .14s ease, transform .14s ease;
        }
        #servicesList button:hover {
           box-shadow: var(--shadow-sm);
            transform: translateY(-2px);
        }

        /* News and Officials were reverted previously — do not change their look,
           but ensure the carousel container has slight separation from background */
        #newsCarouselContainer { box-shadow: none; } /* keep previous visual */

        /* Modal (service form) — stronger elevation to keep it on top */
        #modalServiceForm > #serviceFormContent {
            box-shadow: var(--shadow-lg) !important;
            z-index: 70;
        }
        /* Make sure small controls inside modal keep readable depth */
       #modalServiceForm input[type="file"],
       #modalServiceForm input[type="text"],
      #modalServiceForm select {
           box-shadow: var(--shadow-xs);
       }

/* Keep responsive behavior unchanged; only shadow rules added */
        #servicesList {
            max-height: 260px;
            overflow-y: auto;
            border-radius: 1rem;
            box-shadow: 0 4px 24px rgba(31,38,135,0.10);
            background: #fff;
            margin-top: 0.5rem;
        }
        /* #newsCarouselContainer styles are set inline; no CSS rules needed here */
        #newsCarousel {
            display: flex;
            gap: 2rem;
        }
/* --- FINAL RESPONSIVE NEWS STYLES --- */
.news-item-landscape {
    background: #f9fafb;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(31,38,135,0.08);
    display: flex;
    overflow: hidden;
    /* Mobile-first settings */
    width: 100%;
    flex-direction: column;
    flex-shrink: 0; /* Important for carousel */
}
.news-image-landscape {
    width: 100%;
    height: 180px;
    object-fit: cover;
}
.news-content-landscape {
    width: 100%;
    padding: 1.25rem;
}

/* Desktop Overrides (for screens 768px and wider) */
@media (min-width: 768px) {
    .news-item-landscape {
        width: 500px;
        height: 300px;
        flex-direction: row;
    }
    .news-image-landscape {
        width: 45%;
        height: 100%;
    }
    .news-content-landscape {
        width: 55%;
        padding: 1.5rem;
    }
}
        .news-headline {
            font-size: 1.5rem; /* Increased font size */
            font-weight: 700;
            color: #d97706;
            margin-bottom: 1rem;
        }
        .news-date {
            font-size: 1.1rem; /* Slightly increased font size */
            color: #888;
            margin-bottom: 1rem;
        }
        .news-description {
            font-size: 1.15rem; /* Increased font size */
            color: #555;
            margin-bottom: 1rem;
            /* Remove truncation styles so full description is shown */
            /* overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical; */
        }

        /* Make requirements and gcash boxes visible and consistent with Services page */
        .requirements-box {
            background: #fffbe6;
            border: 1px solid #ffe08a;
            border-radius: 0.7rem;
            padding: 1rem 1.2rem;
            margin-bottom: 1.5rem;
            font-size: 1.01rem;
            color: #7a5a00;
            max-width: 100%;
            box-shadow: 0 2px 8px rgba(255, 200, 0, 0.07);
            /* Match form width and spacing */
            line-height: 1.5;
            font-family: 'Roboto', Arial, sans-serif;
        }
        /* GCash box: wider than regular requirements box, without affecting other .requirements-box usage */
       .gcash-box {
           width: calc(100% + 365px);
              max-width: calc(100% + 365px);
           margin-top: 70px;
           margin-left: -650px;
           box-sizing: border-box;
           padding: 1rem 1.2rem;
           color: #333; /* override text color if needed */
       }
        .requirements-box b {
            color: #b88a00;
            font-weight: 600;
            font-size: 1.08em;
            letter-spacing: 0.5px;
            display: block;
            margin-bottom: 0.3em;
        }
        .requirements-box ul {
            margin: 0.2em 0 0 1.2em;
            padding: 0;
            list-style: disc inside;
        }
        .requirements-box li {
            margin-bottom: 0.18em;
            font-size: 1em;
            font-weight: 400;
            letter-spacing: 0.1px;
        }

        /* Ensure modal content doesn't clip these boxes */
        #serviceFormContent { overflow: visible; }
        #modalServiceForm { align-items: center; justify-content: center; }
        /* make sure grid children span full width when class used */
        .col-span-full { grid-column: 1 / -1; }

        /* Navbar notification badge (match Notifications.html UI/UX) */
        #notifBadge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: #fff;
            border-radius: 9999px;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            line-height: 1;
            box-shadow: 0 1px 2px rgba(0,0,0,0.12);
        }
        /* --- ADD THESE STYLES FOR MOBILE RESPONSIVENESS --- */
        @media (max-width: 767px) {
.news-item-landscape {
    width: 100%;
    height: auto;
    flex-direction: column; /* Image on top, text below */
    background: #f9fafb;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(31,38,135,0.08);
    display: flex;
    overflow: hidden;
}
.news-image-landscape {
    width: 100%;
    height: 180px; /* A fixed height for images on mobile */
    object-fit: cover;
    border-radius: 1rem 1rem 0 0;
}
.news-content-landscape {
    width: 100%;
    padding: 1.25rem; /* A bit of space inside the card */
}@media (min-width: 768px) {
    .news-item-landscape {
        flex-direction: row; /* Image on the left, text on the right */
        height: 300px;
    }
    .news-image-landscape {
        width: 45%;
        height: 100%;
        border-radius: 1rem 0 0 1rem;
    }
    .news-content-landscape {
        width: 55%;
    }
}
            #newsCarouselContainer {
                overflow-x: auto;       /* Allow horizontal scrolling on mobile */
                scroll-snap-type: x mandatory; /* Add smooth snapping effect */
                -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            }
            #newsCarousel {
                /* Disable JS transform for mobile and rely on native scroll */
                transform: none !important; 
            }
        }
    </style>
</head>
<body class="min-h-screen m-0 font-['Roboto',Arial,sans-serif] flex bg-cover bg-fixed bg-center" style="background-image:url('')">
<div class="flex w-full min-h-screen">
  <aside class="hidden md:flex bg-white shadow-lg w-64 min-h-screen flex flex-col py-8 px-4 fixed z-40 top-0 left-0 border-r border-orange-100" style="max-height:100vh;overflow-y:auto;">
  <div class="flex items-center gap-3 mb-6">
    <img src="icon.png" alt="Logo" class="h-8 w-8 rounded-full" />
    <span class="font-extrabold text-lg text-orange-500 tracking-wide">e-Serbisyong Tañong</span>
  </div>

  <nav class="flex flex-col gap-2">
    <a href="Home.html" class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium text-white bg-orange-400 transition relative">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M3 12l2-2m0 0l7-7 7 7m-9 2v8m4-8v8m5 0a2 2 0 002-2V7a2 2 0 00-2-2h-3.5a2 2 0 00-1.5.67" />
      </svg>
      Home
    </a>

    <a href="Services.html" class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium text-gray-800 hover:bg-orange-50 transition">
      <svg class="w-6 h-6 text-orange-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
      </svg>
      Services
    </a>

    <a href="Appointments.html" class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium text-gray-800 hover:bg-orange-50 transition">
      <svg class="w-5 h-5 text-orange-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
      </svg>
      Appointments
    </a>

    <a href="Notifications.html" class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium text-gray-800 hover:bg-orange-50 transition relative" aria-label="Notifications">
      <svg class="w-6 h-6 text-orange-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
      </svg>
      Notifications
      <span id="notifBadge" class="badge hidden" aria-hidden="true">0</span>
    </a>

    <a href="Profile.html" class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium text-gray-800 hover:bg-orange-50 transition">
      <svg class="w-6 h-6 text-orange-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
      Profile
    </a>
  </nav>

  <div class="mt-auto flex flex-col gap-2">
    <button onclick="logout()" class="w-full bg-orange-400 text-white rounded-lg px-4 py-2 font-medium transition hover:bg-orange-300">
      Logout
    </button>
  </div>
</aside>

  <div class="flex-1 md:ml-64 flex flex-col min-h-screen pb-20 md:pb-0">
    <div class="fixed top-0 right-0 z-50 w-full flex justify-end pointer-events-none">
  <div class="flex items-center gap-3 bg-white/95 shadow rounded-bl-2xl px-5 py-2 mt-0 mr-0 pointer-events-auto border-b border-l border-gray-200">
    <img src="https://static.vecteezy.com/system/resources/previews/020/911/731/original/profile-icon-avatar-icon-user-icon-person-icon-free-png.png" alt="Profile" class="h-8 w-8 rounded-full border border-gray-200 object-cover bg-gray-100" />
    <span class="text-base text-gray-700 font-medium" id="userGreet"></span>
  </div>
</div>


      <div class="w-full flex justify-center mt-8 mb-8">
          <hr class="w-3/4 border-t-2 border-gray-200" />
      </div>
      <div class="mt-12 bg-white rounded-2xl shadow-lg px-4 md:px-8 py-12 max-w-5xl w-full mx-auto flex flex-col items-center">
          <div class="text-2xl font-semibold text-gray-900 mb-8 tracking-wide">Barangay News</div>
<div class="w-full md:overflow-hidden" id="newsCarouselContainer">
              <div id="newsCarousel" class="flex flex-col md:flex-row gap-6 w-full">
                  </div>
          </div>
      </div>
<div id="newsModal" class="fixed inset-0 z-50 hidden bg-black/40 justify-center items-center p-4">
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl relative max-h-[90vh] flex flex-col">
    <button onclick="closeNewsModal()" class="absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-3xl font-bold z-10">&times;</button>
    <div id="newsModalContent" class="overflow-y-auto">
        <!-- Content will be injected here -->
    </div>
  </div>
</div>
      <div class="mt-12 mb-8 flex flex-col items-center w-full">
          <div class="text-2xl font-semibold text-gray-900 mb-8 tracking-wide">Barangay Officials</div>
          <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2 md:gap-4 w-full">
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="captain.png" alt="Danny Del Castillo" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Danny Del Castillo</div>
                  <div class="text-sm text-gray-600 text-center">Barangay Captain</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="nelson.png" alt="Nelson Almocera" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Nelson Almocera</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="josh.png" alt="Josh Acuña" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Josh Acuña</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="adams.png" alt="Adams Bernardino" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Adams Bernardino</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="bubut.png" alt="Bubut Barrozo" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Bubut Barrozo</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="joel.png" alt="Joel De Guzman" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Joel De Guzman</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="leo.png" alt="Leo Loresco" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Leo Loresco</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
              <div class="flex flex-col items-center bg-white rounded-xl shadow p-2 md:p-4">
                  <img src="rhom.png" alt="Rhom Berdin" class="h-20 w-20 rounded-full mb-2 object-cover" />
                  <div class="font-bold text-center mb-1">Rhom Berdin</div>
                  <div class="text-sm text-gray-600 text-center">Kagawad</div>
              </div>
          </div>
      </div>
      <div class="modal" id="modalServiceForm" style="display:none;position:fixed;z-index:100;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);justify-content:center;align-items:center;padding:1rem;box-sizing:border-box;overflow-y:auto;">
    <div class="modal-content" id="serviceFormContent" style="background:#fff;border-radius:1.2rem;padding:1.1rem 1.2rem;width:min(92vw,820px);max-width:92vw;box-shadow:0 10px 40px rgba(31,38,135,0.12);position:relative;box-sizing:border-box;max-height:calc(100vh - 96px);overflow-y:auto;word-wrap:break-word;white-space:pre-line;line-height:1.6;text-align:left;font-size:0.98rem;">
        </div>
</div>
    </main>
        <footer class="w-full bg-orange-400 py-4 px-8 text-left text-white text-sm font-bold border-t border-orange-200 mt-auto">
            © 2025 e-Serbisyong Tañong. All rights reserved.
        </footer>
  </div>
</div> 
<script>
        const firebaseConfig = {
        apiKey: "AIzaSyCDT65vncku1avdYSxrCJCM_SE-gN2E2ok",
        authDomain: "e-serbisyong-tanong.firebaseapp.com",
        databaseURL: "https://e-serbisyong-tanong-default-rtdb.firebaseio.com",
        projectId: "e-serbisyong-tanong",
        storageBucket: "e-serbisyong-tanong.firebasestorage.app",
        messagingSenderId: "147646033817",
        appId: "1:147646033817:web:503ac4767a4774a4afad08",
        measurementId: "G-3TDQYZTF1H"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        const auth = firebase.auth();
        let newsCarouselIndex = 0;
let newsCarouselTimer = null;
        const db = firebase.database();
        
                function startNewsCarousel() {
    const carousel = document.getElementById('newsCarousel');
    const items = carousel.children;

    // --- Critical Check: Stop and reset animation on mobile ---
    if (window.innerWidth < 768) {
        if (newsCarouselTimer) clearInterval(newsCarouselTimer); // Stop any existing timer
        carousel.style.transition = 'none'; // Remove animation
        carousel.style.transform = 'none'; // Reset JS positioning
        return; // Exit the function
    }

    // --- Desktop Animation Logic (runs only if not on mobile) ---
    if (items.length <= 1) return; // No need to scroll if only one item

    // Clone items to create a seamless loop
    const allItems = Array.from(items);
    allItems.forEach(item => {
        carousel.appendChild(item.cloneNode(true));
    });

    let currentIndex = 0;
    function slide() {
        currentIndex++;
        const itemWidth = items[0].offsetWidth + 32; // 32px for 2rem gap
        
        // Apply the transition
        carousel.style.transition = 'transform 0.7s ease-in-out';
        carousel.style.transform = `translateX(-${currentIndex * itemWidth}px)`;

        // When the transition to the first cloned item finishes, jump back to the start
        if (currentIndex === allItems.length) {
            setTimeout(() => {
                carousel.style.transition = 'none'; // Disable transition for the jump
                currentIndex = 0;
                carousel.style.transform = 'translateX(0)';
            }, 700); // This timeout must match the transition duration
        }
    }

    if (newsCarouselTimer) clearInterval(newsCarouselTimer); // Clear previous timer
    newsCarouselTimer = setInterval(slide, 3500); // Start the new timer
}
        // --- LANDSCAPE NEWS CAROUSEL ---
        function fetchNews() {
            db.ref('news').once('value').then(snapshot => {
                const carousel = document.getElementById('newsCarousel');
                carousel.innerHTML = ""; // Clear existing content
                const data = snapshot.val();

                if (data) {
                    const newsArray = Object.values(data).reverse(); // Reverse order for FILO
                    newsArray.forEach(news => {
                        
                        const div = document.createElement('div');
                        div.className = 'news-item-landscape';
                        div.onclick = () => openNewsModal(news); // Make the entire item clickable
                        div.style.cursor = "pointer"; // Add pointer cursor for clarity
                        div.innerHTML = `
                            ${news.image ? `<img src="${news.image}" alt="News Image" class="news-image-landscape">` : `<div class="news-image-landscape"></div>`}
                            <div class="news-content-landscape">
                                <div class="news-headline">${news.headline || ''}</div>
                                <div class="news-date">${news.date || ''}</div>
                                <div class="news-description">${news.description || ''}</div>
                            </div>
                        `;
                        carousel.appendChild(div);
                    });
                } else {
                    carousel.innerHTML = `<div class="news-item-landscape flex items-center justify-center text-gray-500">No news available.</div>`;
                }
                startNewsCarousel();
            });
        }

        function getUser() {
            return JSON.parse(localStorage.getItem('user')) || { fullname: "User" };
        }
function showUserGreet() {
    const user = getUser();
    const greetEl = document.getElementById('userGreet');
    if (greetEl && user && user.fullname) {
        greetEl.textContent = `Hi, ${user.fullname.split(' ')[0]}!`;
    } else if (greetEl) {
        greetEl.textContent = "Hi, User!";
    }
}
        function logout() {
            localStorage.removeItem('user');
            window.location.href = 'Login.html';
        }

                // Fetch notification count for badge
        function fetchNotificationCount() {
            const user = getUser();
            const uid = user && user.uid ? user.uid : null;
            const badge = document.getElementById('notifBadge');
            if (!uid || !badge) return;

            // detach previous listener if any
            if (window._homeNotifRef) {
                try { window._homeNotifRef.off(); } catch (e) { /* ignore */ }
            }

            const ref = db.ref('notifications').orderByChild('userId').equalTo(uid);
            ref.on('value', snapshot => {
                const data = snapshot.val() || {};
                let unread = 0;
                Object.values(data).forEach(n => {
                    if (!n) return;
                    if (n.read === false || n.read === undefined || n.read === null) unread++;
                });
                if (unread > 0) {
                    badge.textContent = unread > 99 ? '99+' : unread;
                    badge.classList.remove('hidden');
                    badge.setAttribute('title', `${unread} unread notification${unread > 1 ? 's' : ''}`);
                    badge.setAttribute('aria-label', `${unread} unread notifications`);
                    badge.setAttribute('aria-hidden', 'false');
                } else {
                    badge.classList.add('hidden');
                    badge.removeAttribute('title');
                    badge.setAttribute('aria-hidden', 'true');
                }
            }, err => {
                console.error('fetchNotificationCount error', err);
            });

            window._homeNotifRef = ref;
        }

        window.onload = function() {
            showUserGreet();
            fetchNews();
            fetchNotificationCount();
        }

        // --- SERVICES DATA (from Services.html) ---
        const allServices = [
            // Infrastructure
            { key: 'infraFencing', name: 'Fencing' },
            { key: 'infraExcavationRes', name: 'Excavation / Digging / Driveway Ramp (Residential Area)' },
            { key: 'infraExcavationCom', name: 'Excavation (Commercial Area, except Telcos)' },
            { key: 'infraRenovation', name: 'Renovation (Vertical/Horizontal Improvements)' },
            { key: 'infraRetrofitting', name: 'Retrofitting (Complex Structure – Above 3 Storeys / Industrial)' },
            { key: 'infraBuilding', name: 'Building' },
            { key: 'infraDemolition', name: 'Demolition' },
            { key: 'infraPostsMeralco', name: 'Posts for Utility Companies – Meralco' },
            { key: 'infraPostsTelcos', name: 'Posts for Utility Companies – Telcos' },
            { key: 'infraCablingTelco', name: 'Cabling/Wiring from Telecommunications Company' },
            { key: 'infraPipelayingMW', name: 'Pipelaying of Manila Water' },
            { key: 'infraAppElectric', name: 'Application for Electric Meter' },
            { key: 'infraAppWater', name: 'Application for Water Meter' },
            { key: 'infraAppInternet', name: 'Application for Internet / Cable / Telecommunication' },
            // Social
            { key: 'socialIndigency', name: 'Certificate of Indigency' },
            { key: 'socialJobseekers', name: 'First-Time Jobseekers (RA 11261)' },
            { key: 'socialPAO', name: 'PAO Assistance (Low/No Income)' },
            { key: 'socialBurial', name: 'Burial Certification (Death at Home, Non-COVID)' },
            { key: 'socialResidencyEmployment', name: 'Certificate of Residency – Employment' },
            { key: 'socialBailBond', name: 'Bail Bond' },
            { key: 'socialLoans', name: 'Loans' },
            { key: 'socialBankTrans', name: 'Bank Transactions' },
            { key: 'socialLateReg', name: 'Late Registration (Birth Certificate)' },
            { key: 'socialNBIPolice', name: 'NBI / Police Clearance' },
            { key: 'socialSeniorID', name: 'Senior Citizen ID' },
            { key: 'socialPWDID', name: 'PWD ID' },
            { key: 'socialPostalID', name: 'Postal ID' },
            { key: 'socialVisa', name: 'Visa Application' },
            { key: 'socialCalamity', name: 'Calamity Victims (Flood/Typhoon)' },
            { key: 'socialLocalEmployment', name: 'Local Employment / TNVS Application' },
            // General Documents
            { key: 'genClearance', name: 'Barangay Clearance' },
            { key: 'genResidency', name: 'Barangay Residency Certificate' },
            { key: 'genGoodMoral', name: 'Certificate of Good Moral Character' },
            { key: 'genEmployment', name: 'Certificate of Employment' },
            { key: 'genBrgyID', name: 'Barangay ID' },
            { key: 'genNoBirthCert', name: 'No Birth Certificate' },
            { key: 'genMissingPerson', name: 'Missing Person Assistance' },
            { key: 'genKP', name: 'Katarungang Pambarangay' },
            { key: 'genFacilities', name: 'Barangay Facilities Rental' },
            { key: 'genEscort', name: 'Escort – Interment' },
            { key: 'genLicenseToCarry', name: 'License to Carry' },
            { key: 'genNonResidence', name: 'Certification for Non-Residence' },
            { key: 'genDeceasedResident', name: 'Certification for Deceased Resident' },
            { key: 'genDeathAtHome', name: 'Certification for Death at Home (Non-COVID)' },
            { key: 'genTransferResidence', name: 'Transfer of Residence' },
            { key: 'genTransferBelongings', name: 'Transfer of Belongings' },
            { key: 'genCessationBusiness', name: 'Cessation of Business' },
            { key: 'genNoIncome', name: 'No Income / Low Income Certification' },
            { key: 'genChangeHouseNo', name: 'Change of House Number' },
            { key: 'genSeniorBedridden', name: 'Certification for Senior Citizen (Bedridden) / Certification of Relationship' },
            { key: 'genLogistics', name: 'Logistical Support' },
            { key: 'genLeave', name: 'Application of Leave of Absence' },
            { key: 'genRoadClosure', name: 'Road Closure' },
            // Others
            { key: 'otherPetMemorial', name: 'Pet Memorial Garden' },
            { key: 'otherFlushing', name: 'Flushing Operation' },
            { key: 'otherTrimming', name: 'Trimming' },
            { key: 'otherManhole', name: 'Repair of Manhole' },
            { key: 'otherHakotKuyagot', name: 'Hakot Kuyagot' },
            { key: 'otherHakotPanambak', name: 'Hakot Panambak' }
        ];

        // --- SERVICE FORM FIELDS (from Services.html, now with requirements) ---
        const unifiedFields = [
            { label: "First Name*", type: "text", required: true },
            { label: "Middle Name*", type: "text", required: true },
            { label: "Surname*", type: "text", required: true },
            { label: "Birthday*", type: "date", required: true },
            { label: "Birthplace*", type: "text", required: true },
            { label: "Gender", type: "select", options: ["Select", "Male", "Female", "Other"], required: false },
            { label: "Citizenship", type: "text", required: false },
            { label: "Address*", type: "text", required: true },
            { label: "Civil Status", type: "select", options: ["Select", "Single", "Married", "Widowed", "Separated"], required: false },
            { label: "Religion", type: "text", required: false },
            { label: "Precint No.", type: "text", required: false },
            { label: "Brgy. ID", type: "text", required: false },
            { label: "Contact No.*", type: "text", required: true },
            { label: "Occupation", type: "text", required: false },
            { label: "In case of Emergency*", type: "text", required: true }
        ];

        // Map all services to use unifiedFields for demo
        const serviceForms = {
            // INFRASTRUCTURE
            infraFencing: {
                title: "Fencing Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (Subdivision), If not applied, submit Special Power of Attorney</li><b><li>Payment: ₱500.00</li></b></ul>`
            },
            infraExcavationRes: {
                title: "Excavation / Digging / Driveway Ramp (Residential Area) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (Subdivision), If not applied, submit Special Power of Attorney</li><b><li>Payment:<br> Main Road: ₱3,000.00<br> Secondary Road: ₱2,000.00</li></b></ul>`
            },
            infraExcavationCom: {
                title: "Excavation (Commercial Area, except Telcos) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>Contract Agreement (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li><b><li>Payment:<br> Main Road: ₱3,000.00<br> Secondary Road: ₱2,000.00</li></b></ul>`
            },
            infraRenovation: {
                title: "Renovation (Vertical/Horizontal Improvements) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (Subdivision), If not applied, submit Special Power of Attorney</li></ul>`
            },
            infraRetrofitting: {
                title: "Retrofitting (Complex Structure – Above 3 Storeys / Industrial) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>Perspective plan (Original/CTC and 1 Photocopy)</li><li>Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li></ul>`
            },
            infraBuilding: {
                title: "Building Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>For CMP programs: Certificate of Full Payment or Contract (Original/CTC and 1 Photocopy)</li><li>Building plan (Original/CTC and 1 Photocopy)</li><li>Perspective plan (Original/CTC and 1 Photocopy)</li><li>Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li></ul>`
            },
            infraDemolition: {
                title: "Demolition Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land title (Original/CTC and 1 Photocopy)</li><li>For CMP programs: Certificate of Full Payment or Contract (Original/CTC and 1 Photocopy)</li><li>Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li><li>Latest picture of the building to be demolished</li></ul>`
            },
            infraPostsMeralco: {
                title: "Posts for Utility Companies – Meralco Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Scope of Work (1 Original and 1 Photocopy)</li><li>Letter of Intent</li></ul>`
            },
            infraPostsTelcos: {
                title: "Posts for Utility Companies – Telcos Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Subject for inquiry (refer to Memorandum)</li></ul>`
            },
            infraCablingTelco: {
                title: "Cabling/Wiring from Telecommunications Company Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Scope of Work (1 Original and 1 Photocopy)</li><li>Letter of Intent</li><li>Approved Request to Attach from MERALCO</li></ul>`
            },
            infraPipelayingMW: {
                title: "Pipelaying of Manila Water Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Manila Water Form (1 Photocopy + Presentation of Original)</li><li>Letter of Intent</li></ul>`
            },
            infraAppElectric: {
                title: "Application for Electric Meter Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land Title (Original/CTC and 1 Photocopy) OR CMP Certificate/Contract OR Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li></ul>`
            },
            infraAppWater: {
                title: "Application for Water Meter Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land Title (Original/CTC and 1 Photocopy) OR CMP Certificate/Contract OR Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li></ul>`
            },
            infraAppInternet: {
                title: "Application for Internet / Cable / Telecommunication Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID (Original and 1 Photocopy)</li><li>Land Title (Original/CTC and 1 Photocopy) OR CMP Certificate/Contract OR Deed of Absolute Sale (Original and Photocopy)</li><li>HOA Clearance (if applicable); if not personally applied, submit Special Power of Attorney</li></ul>`
            },
            // SOCIAL
            socialIndigency: {
                title: "Certificate of Indigency Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>1 Government-issued Valid ID</li><li>Secondary ID (Barangay ID, School ID, Postal, TIN, Police Clearance, Company ID) OR HOA Certification + any ID</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li></ul>`
            },
            socialJobseekers: {
                title: "First-Time Jobseekers (RA 11261) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as Indigency requirements</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li></ul>`
            },
            socialPAO: {
                title: "PAO Assistance (Low/No Income) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>1 Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li></ul>`
            },
            socialBurial: {
                title: "Burial Certification (Death at Home, Non-COVID) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>1 Valid ID of immediate family</li><li>Secondary ID</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li><li>Response Sheet from Rescue 161 OR Physician’s Declaration (with license number)</li></ul>`
            },
            socialResidencyEmployment: {
                title: "Certificate of Residency – Employment Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>1 Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li><li>If not personally applied → Authorization + valid ID</li></ul>`
            },
            socialBailBond: {
                title: "Bail Bond Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>1 Valid ID of co-habitant or immediate family</li><li>Secondary ID or any ID</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li><li>Certificate of Detention</li><li>If not personally applied → Authorization + valid ID</li></ul>`
            },
            socialLoans: {
                title: "Loans Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as Residency/Employment requirements</li><li>Filled-out form</li><li>Current Community Tax Certificate (Cedula)</li></ul>`
            },
            socialBankTrans: {
                title: "Bank Transactions Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as Loans requirements</li><li>Filled-out form</li><li>Cedula</li><li>Authorization + valid ID if not personally applied</li></ul>`
            },
            socialLateReg: {
                title: "Late Registration (Birth Certificate) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID + Secondary ID (OR HOA Cert + ID)</li><li>Filled-out form</li><li>Cedula</li><li>PSA Negative Result OR Affidavit of Two Disinterested Persons</li></ul>`
            },
            socialNBIPolice: {
                title: "NBI / Police Clearance Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID + Secondary ID (OR HOA Cert + ID)</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            socialSeniorID: {
                title: "Senior Citizen ID Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as NBI clearance requirements</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            socialPWDID: {
                title: "PWD ID Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as Senior Citizen ID requirements</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            socialPostalID: {
                title: "Postal ID Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as PWD ID requirements</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            socialVisa: {
                title: "Visa Application Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as Postal ID requirements</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            socialCalamity: {
                title: "Calamity Victims (Flood/Typhoon) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as Visa Application requirements</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            socialLocalEmployment: {
                title: "Local Employment / TNVS Application Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Same as standard employment clearance</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            // GENERAL DOCUMENTS
            genClearance: {
                title: "Barangay Clearance Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Cedula</li><b><li>Payment:<br> For Employment: ₱50.00 / For Loan: ₱100.00 / For Legal use: ₱100.00 / For Bank: ₱100.00 / For Police: ₱100.00</li></b></ul>`
            },
            genResidency: {
                title: "Barangay Residency Certificate Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Cedula</li><b><li>Payment: ₱50.00 </li></b></ul>`
            },
            genGoodMoral: {
                title: "Certificate of Good Moral Character Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Cedula</li><b><li>Payment: ₱100.00</li></b></ul>`
            },
            genEmployment: {
                title: "Certificate of Employment Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Cedula</li><b><li>Payment: ₱100.00</li></b></ul>`
            },
            genBrgyID: {
                title: "Barangay ID Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Proof of Address</li><b><li>Payment: ₱100.00 <br> Senior/PWD/Student: ₱50.00</li></b></ul>`
            },
            genNoBirthCert: {
                title: "No Birth Certificate Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Cedula</li><b><li>Payment: ₱100.00</li></b></ul>`
            },
            genMissingPerson: {
                title: "Missing Person Assistance Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID</li></ul>`
            },
            genKP: {
                title: "Katarungang Pambarangay Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID</li><b><li>Payment:<br> Ordinary Case: ₱150.00 / Monetary Case: ₱200.00</li></b></ul>`
            },
            genFacilities: {
                title: "Barangay Facilities Rental Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Barangay Clearance</li></ul>`
            },
            genEscort: {
                title: "Escort – Interment Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Barangay Clearance</li></ul>`
            },
            genLicenseToCarry: {
                title: "License to Carry Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Government-issued Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Duly accomplished request form</li><li>Cedula</li></ul>`
            },
            genNonResidence: {
                title: "Certification for Non-Residence Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Filled-out form</li><li>Cedula</li></ul>`
            },
            genDeceasedResident: {
                title: "Certification for Deceased Resident Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID of next of kin / family member</li><li>Secondary ID</li><li>Cedula</li><li>Proof of death (Death Certificate / Physician’s Declaration / Barangay record)</li></ul>`
            },
            genDeathAtHome: {
                title: "Certification for Death at Home (Non-COVID) Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID of immediate family</li><li>Secondary ID</li><li>Cedula</li><li>Response Sheet from Rescue 161 OR Physician’s Declaration (with license number)</li></ul>`
            },
            genTransferResidence: {
                title: "Transfer of Residence Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Cedula</li><li>Proof of new address (if available)</li></ul>`
            },
            genTransferBelongings: {
                title: "Transfer of Belongings Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID</li><li>Cedula</li><li>Barangay Inspection Report (if required)</li></ul>`
            },
            genCessationBusiness: {
                title: "Cessation of Business Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID of business owner / representative</li><li>Barangay Business Permit</li><li>Cedula</li><li>Affidavit of Business Closure</li></ul>`
            },
            genNoIncome: {
                title: "No Income / Low Income Certification Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Secondary ID OR HOA Cert + ID</li><li>Cedula</li></ul>`
            },
            genChangeHouseNo: {
                title: "Change of House Number Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID of homeowner</li><li>Secondary ID OR HOA Cert + ID</li><li>Cedula</li><li>Proof of address (utility bill, deed of sale, lease contract, or old house number certificate)</li></ul>`
            },
            genSeniorBedridden: {
                title: "Certification for Senior Citizen (Bedridden) / Certification of Relationship Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID of Senior Citizen / immediate family</li><li>Secondary ID OR HOA Cert + ID</li><li>Cedula</li><li>Medical Certificate (if bedridden)</li><li>Proof of relationship (PSA documents / Affidavit if needed)</li></ul>`
            },
            genLogistics: {
                title: "Logistical Support Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li></ul>`
            },
            genLeave: {
                title: "Application of Leave of Absence Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Letter of request</li></ul>`
            },
            genRoadClosure: {
                title: "Road Closure Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li><li>Barangay clearance or authorization</li></ul>`
            },
            // OTHERS
            otherPetMemorial: {
                title: "Pet Memorial Garden Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li></ul>`
            },
            otherFlushing: {
                title: "Flushing Operation Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li></ul>`
            },
            otherTrimming: {
                title: "Trimming Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li></ul>`
            },
            otherManhole: {
                title: "Repair of Manhole Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li></ul>`
            },
            otherHakotKuyagot: {
                title: "Hakot Kuyagot Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li><b><li>Payment for Private Companies: ₱1,000.00 per truckload</li></b></ul>`
            },
            otherHakotPanambak: {
                title: "Hakot Panambak Form",
                fields: unifiedFields,
                requirements: `<b>Requirements</b><ul><li>Valid ID</li><li>Request letter</li></ul>`
            }
        };

       

        // --- SERVICE FORM MODAL LOGIC (SHARED WITH Services.html) ---
    function openServiceForm(key) {
        // Always fetch the latest user info from Firebase before showing the form
        const localUser = getUser();
        if (!localUser || !localUser.uid) {
            alert('Please sign in before submitting a service request.');
            return;
        }

        const container = document.getElementById('serviceFormContent');
        container.innerHTML = `<div class="text-center py-8 text-lg text-gray-700">Loading your profile...</div>`;
        const modal = document.getElementById('modalServiceForm');
        modal.style.display = 'flex';
        modal.style.alignItems = 'center';
        modal.style.justifyContent = 'center';
        modal.style.padding = '1.5rem';

        // Fetch latest user info from Firebase and update localStorage
        firebase.database().ref('users/' + localUser.uid).once('value').then(snapshot => {
            const data = snapshot.val() || {};
            const merged = {
                uid: localUser.uid,
                firstname: data.firstname || "",
                middlename: data.middlename || "",
                lastname: data.lastname || "",
                fullname: (data.firstname || "") + " " + (data.middlename || "") + " " + (data.lastname || ""),
                email: localUser.email || "",
            };
            localStorage.setItem('user', JSON.stringify(merged));

            // Use the latest info for autofill
            const user = merged;
            const escapeHtml = (str) =>
                String(str || '').replace(/[&<>"']/g, m => ({
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#39;'
                }[m]));

            const firstName = escapeHtml(user.firstname || '');
            const middleName = escapeHtml(user.middlename || '');
            const lastName = escapeHtml(user.lastname || '');

            const def = serviceForms[key] || { title: (key || 'Service'), fields: unifiedFields };
            let fields = def.fields;
            // If you have special fields for certain keys, add here as in Services.html
            // if (key === 'otherHakotKuyagot') fields = hakotKuyagotFields;
            // if (key === 'genFacilities') fields = tentsChairsFields;
            // if (key === 'genLogistics') fields = lipatBahayFields;

            const title = def.title || 'Service Form';

            // Check if requirements mention payment
            let showGcash = false;
            let requirementsHtml = def.requirements || '';
            if (def.requirements && /payment|₱|php|fee/i.test(def.requirements)) {
                showGcash = true;
                let reqListMatch = requirementsHtml.match(/<ul>([\s\S]*?)<\/ul>/);
                if (reqListMatch) {
                    let reqList = reqListMatch[1];
                    if (!/Payment Receipt/.test(reqList)) {
                        reqList += '<li><b>Payment Receipt (Gcash, Bank Transfer)</b></li>';
                    }
                    requirementsHtml = requirementsHtml.replace(/<ul>[\s\S]*?<\/ul>/, `<ul>${reqList}</ul>`);
                } else {
                    requirementsHtml = `<ul>${requirementsHtml}<li><b>Payment Receipt (Gcash, Bank Transfer)</b></li></ul>`;
                }
            }

            // Prefilled name fields
            let fieldsHtml = `
                <label style="font-size:0.95rem;font-weight:500;color:#333;margin-bottom:0.13rem;display:flex;flex-direction:column;gap:0.18rem;background:none;min-width:0;">
                    First Name*
                    <input type="text" name="first_name" value="${firstName}" required readonly class="bg-gray-150 cursor-not-allowed" style="padding:0.32rem 0.5rem;border-radius:0.5rem;border:1px solid #ccc;font-size:0.95rem;background:#f8f8f8;font-family:inherit;margin-top:0.07rem;margin-bottom:0.07rem;transition:border 0.18s;min-width:0;width:100%;box-sizing:border-box;" />
                </label>
                <label style="font-size:0.95rem;font-weight:500;color:#333;margin-bottom:0.13rem;display:flex;flex-direction:column;gap:0.18rem;background:none;min-width:0;">
                    Middle Name
                    <input type="text" name="middle_name" value="${middleName}" class="bg-white" style="padding:0.32rem 0.5rem;border-radius:0.5rem;border:1px solid #ccc;font-size:0.95rem;background:#f8f8f8;font-family:inherit;margin-top:0.07rem;margin-bottom:0.07rem;transition:border 0.18s;min-width:0;width:100%;box-sizing:border-box;" />
                </label>
                <label style="font-size:0.95rem;font-weight:500;color:#333;margin-bottom:0.13rem;display:flex;flex-direction:column;gap:0.18rem;background:none;min-width:0;">
                    Last Name*
                    <input type="text" name="last_name" value="${lastName}" required readonly class="bg-gray-150 cursor-not-allowed" style="padding:0.32rem 0.5rem;border-radius:0.5rem;border:1px solid #ccc;font-size:0.95rem;background:#f8f8f8;font-family:inherit;margin-top:0.07rem;margin-bottom:0.07rem;transition:border 0.18s;min-width:0;width:100%;box-sizing:border-box;" />
                </label>
            `;

            // Add the rest of the dynamic fields (skip name fields)
            fieldsHtml += fields
                .filter(f => !/first name|middle name|surname|last name/i.test(f.label))
                .map((f, i) => {
                    const name = 'f_' + i + '_' + (f.label || '')
                        .replace(/[\s*\/.#$[\]]+/g, '_')
                        .toLowerCase();
                    const required = f.required ? 'required' : '';
                    if (f.type === 'select') {
                        const options = (f.options || []).map(opt => `<option value="${opt}">${opt}</option>`).join('');
                        return `<label style="font-size:0.95rem;font-weight:500;color:#333;margin-bottom:0.13rem;display:flex;flex-direction:column;gap:0.18rem;background:none;min-width:0;">${f.label}<select name="${name}" ${required} style="padding:0.32rem 0.5rem;border-radius:0.5rem;border:1px solid #ccc;font-size:0.95rem;background:#f8f8f8;font-family:inherit;margin-top:0.07rem;margin-bottom:0.07rem;transition:border 0.18s;min-width:0;width:100%;box-sizing:border-box;">${options}</select></label>`;
                    }
                    if (f.type === 'label') {
                        return `<div class="requirements-box" style="grid-column:1/-1;padding:0.45rem 0.6rem;margin:0.2rem 0;font-weight:600;color:#333;background:transparent;border:0;">${f.label}</div>`;
                    }
                    const inputType = f.type === 'number' ? 'number' : (f.type === 'date' ? 'date' : 'text');
                    return `<label style="font-size:0.95rem;font-weight:500;color:#333;margin-bottom:0.13rem;display:flex;flex-direction:column;gap:0.18rem;background:none;min-width:0;">${f.label}<input type="${inputType}" name="${name}" ${required} style="padding:0.32rem 0.5rem;border-radius:0.5rem;border:1px solid #ccc;font-size:0.95rem;background:#f8f8f8;font-family:inherit;margin-top:0.07rem;margin-bottom:0.07rem;transition:border 0.18s;min-width:0;width:100%;box-sizing:border-box;" /></label>`;
                }).join('');

            const gcashRefHtml = `<label style="font-size:0.95rem;font-weight:500;color:#333;margin-bottom:0.13rem;display:flex;flex-direction:column;gap:0.18rem;background:none;min-width:0;">Gcash payment Reference #<input type="text" name="gcash_reference" required style="padding:0.32rem 0.5rem;border-radius:0.5rem;border:1px solid #ccc;font-size:0.95rem;background:#f8f8f8;font-family:inherit;margin-top:0.07rem;margin-bottom:0.07rem;transition:border 0.18s;min-width:0;width:100%;box-sizing:border-box;" /></label>`;
            const gcashBoxHtml = '<div class="requirements-box gcash-box" style="width:calc(100% + 365px);max-width:calc(100% + 365px);margin-top:70px;margin-left:-650px;box-sizing:border-box;padding:1rem 1.2rem;color:#333;">Gcash Account — 0919 874 2869 — Arvinne Vergara (Barangay Secretary)</div>';
            const uploadHtml = `
                <label class="upload-label" style="font-size:0.95rem;font-weight:500;color:#333;margin-top:0.3rem;margin-bottom:0.3rem;display:flex;flex-direction:column;gap:0.18rem;grid-column:1/-1;">
                    Attachments (optional)
                    <input type="file" name="attachments" class="upload-input" multiple style="margin-top:0.2rem;font-size:0.95rem;border-radius:0.5rem;border:1px solid #ccc;background:#f8f8f8;padding:0.35rem 0.6rem;font-family:inherit;" />
                </label>
            `;
            container.innerHTML = `
                <button class="close-modal" onclick="closeModal('modalServiceForm')" style="position:absolute;top:0.6rem;right:0.8rem;background:gray;border:none;font-size:1.8rem;color:#e0e0e0;cursor:pointer;transition:color 0.18s;width:30px;">&times;</button>
                <div class="form-title" style="font-size:1.15rem;font-weight:900;color:#fff;background:linear-gradient(90deg,#d97706 0%,#FFB877 100%);text-align:center;margin-bottom:0.7rem;margin-top:0.2rem;letter-spacing:1.5px;text-transform:uppercase;border-radius:0.7rem;padding:0.4rem 0;display:block;box-shadow:0 2px 8px rgba(255,165,0,0.10);width:100%;">${title}</div>
                <div class="requirements-box" style="display:none;" id="serviceReqBox"></div>
                <form id="serviceForm" class="service-form" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:0.5rem 0.8rem;max-width:100%;width:100%;margin:0 auto;padding:0;box-sizing:border-box;">
                    ${fieldsHtml}
                    ${showGcash ? gcashBoxHtml + gcashRefHtml : ''}
                    ${uploadHtml}
                    <div style="grid-column:1/-1;display:flex;justify-content:center;margin-top:8px;">
                        <button type="submit" class="submit-btn" style="background:#d97706;color:#fff;border:none;border-radius:0.7rem;padding:0.45rem 0;font-size:0.95rem;font-weight:500;margin-top:0.6rem;cursor:pointer;transition:background 0.18s;width:36%;max-width:220px;justify-self:center;">Submit</button>
                    </div>
                </form>
            `;
            const reqBox = document.getElementById('serviceReqBox');
            if (requirementsHtml) {
                reqBox.style.display = 'block';
                reqBox.innerHTML = requirementsHtml;
            } else {
                reqBox.style.display = 'none';
            }

            // Modal form validation for fields that must not accept numbers
            const formEl = document.getElementById('serviceForm');
            formEl.onsubmit = function(ev) {
                // Validate fields before submit
                let valid = true;
                // Field names to check (by input[name])
                const mustNotHaveNumbers = [
                    'middle_name', // Middle Name
                    ...Array.from(formEl.querySelectorAll('input,select')).filter(input =>
                        [
                            'birthplace',
                            'citizenship',
                            'religion',
                            'occupation'
                        ].some(field =>
                            input.name.toLowerCase().includes(field)
                        )
                    ).map(input => input.name)
                ];
                // Remove duplicates
                const uniqueFields = [...new Set(mustNotHaveNumbers)];
                uniqueFields.forEach(fieldName => {
                    const input = formEl.querySelector(`[name="${fieldName}"]`);
                    if (input && hasNumbers(input.value)) {
                        showFieldError(input, "This field must not contain numbers.");
                        valid = false;
                    } else if (input) {
                        clearFieldError(input);
                    }
                });
                if (!valid) {
                    ev.preventDefault();
                    return false;
                }
                // ...existing code...
                ev.preventDefault();
                alert('Form submitted! (Demo only)');
                closeModal('modalServiceForm');
            };
        });
    }

    function closeModal(id) {
        document.getElementById(id).style.display = 'none';
    }
    window.openServiceForm = openServiceForm; // for inline onclick

      
        // --- REDIRECT TO SERVICE ---
        function redirectToService(serviceType) {
           
            window.location.href = `Services.html?modal=${serviceType}`;
        }

        // News Modal logic
function openNewsModal(news) {
  const modal = document.getElementById('newsModal');
  const content = document.getElementById('newsModalContent');

  // This new layout uses flexbox to be responsive.
  // It's a single column on mobile and two columns on medium screens (md:) and up.
  content.innerHTML = `
    <div class="md:flex">
        ${news.image ? `
            <div class="w-full md:w-1/2 flex-shrink-0">
                <img src="${news.image}" alt="News Image" class="w-full h-full object-cover md:rounded-l-2xl md:rounded-r-none">
            </div>
        ` : ''}
        <div class="p-6 md:p-8 flex-1">
            <h2 class="text-3xl font-bold text-orange-600 mb-3">${news.headline || ''}</h2>
            <p class="text-gray-500 text-sm mb-6">${news.date || ''}</p>
            <div class="text-base text-gray-800 leading-relaxed whitespace-pre-wrap">${news.description || ''}</div>
        </div>
    </div>
  `;
  
  modal.classList.remove('hidden');
  modal.style.display = 'flex';
  // Prevent the main page from scrolling while the modal is open
  document.body.style.overflow = 'hidden'; 
}
function closeNewsModal() {
  document.getElementById('newsModal').classList.add('hidden');
  document.getElementById('newsModal').style.display = 'none';
  // Restore the ability to scroll the main page
  document.body.style.overflow = '';
}
        window.openNewsModal = openNewsModal;
        window.closeNewsModal = closeNewsModal;

  // Appointment form handler (same behavior as Appointments.html) ------------------------------------------------
  (function() {
    // db is already initialized earlier in this file
    const apptForm = document.getElementById('appointmentForm');
    const feedbackEl = document.getElementById('appointmentFeedback');

    function getUserSafe() {
      try { return JSON.parse(localStorage.getItem('user')) || null; } catch { return null; }
    }

    if (apptForm) {
      apptForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        const name = document.getElementById('name').value.trim();
        const contact = document.getElementById('contact').value.trim();
        const date = document.getElementById('date').value;
        const reason = document.getElementById('reason').value.trim();
        if (!name || !contact || !date || !reason) {
          alert('Please fill all fields.');
          return;
        }

        const user = getUserSafe();
        const payload = {
          uid: user && user.uid ? user.uid : null,
          name, contact, date, reason,
          status: 'Pending',
          rejectionReason: null,
          timestamp: Date.now()
        };

        try {
          const ref = firebase.database().ref('appointments').push();
          await ref.set(payload);
          feedbackEl.textContent = 'Appointment request submitted. You will be notified of updates.';
          feedbackEl.style.display = 'block';
          apptForm.reset();
          // hide feedback after a short delay
          setTimeout(() => { feedbackEl.style.display = 'none'; }, 6000);
        } catch (err) {
          console.error(err);
          alert('Failed to submit appointment. Try again.');
        }
      });
    }
  })();
    </script>
  </div>
</div>
<!-- START: Universal Modal, Content, and Links -->

<!-- 1. Embedded Content Templates -->
<template id="about-content">
    <h2 class="text-2xl font-bold text-orange-600 mb-4">About e-Serbisyong Tañong</h2>
    <div class="space-y-4 text-gray-700 leading-relaxed">
        <p><strong>e-Serbisyong Tañong</strong> is a digital platform designed to bridge the gap between the residents of Barangay Tañong and their local government. Our mission is to provide a modern, accessible, and efficient way for community members to access essential barangay services from anywhere, at any time.</p>
        <h3 class="text-lg font-semibold text-gray-800 pt-2">Key Features</h3>
        <ul class="list-disc list-inside space-y-2">
            <li><strong>Online Service Requests:</strong> Apply for clearances, permits, and other essential documents without needing to visit the barangay hall in person.</li>
            <li><strong>Appointment Scheduling:</strong> Easily book appointments with barangay officials, reducing wait times and ensuring you are attended to promptly.</li>
            <li><strong>Profile Management:</strong> Keep your personal information up-to-date to ensure seamless and accurate processing of your requests.</li>
            <li><strong>Real-time Notifications:</strong> Stay informed with instant updates on the status of your service requests and appointments.</li>
        </ul>
        <p>This platform was developed with the goal of promoting transparency, improving public service delivery, and empowering our residents through technology. We are committed to continuously improving this service to better meet the needs of our community.</p>
    </div>
</template>

<template id="privacy-content">
    <h2 class="text-2xl font-bold text-orange-600 mb-4">Privacy Policy</h2>
    <div class="space-y-4 text-gray-700 leading-relaxed">
        <p class="text-sm text-gray-500">Last updated: October 17, 2025</p>
        <p>e-Serbisyong Tañong ("we," "us," or "our") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our web application.</p>
        <h3 class="text-lg font-semibold text-gray-800 pt-2">Information We Collect</h3>
        <ul class="list-disc list-inside space-y-2">
            <li><strong>Personal Data:</strong> Personally identifiable information, such as your name, address, email address, and telephone number, that you voluntarily give to us when you register or request services.</li>
            <li><strong>Uploaded Documents:</strong> Files and images you upload, such as a Barangay ID, are collected to verify your identity and fulfill service requirements. These are stored securely.</li>
        </ul>
        <h3 class="text-lg font-semibold text-gray-800 pt-2">How We Use Your Information</h3>
        <p>Having accurate information permits us to provide you with a smooth, efficient, and customized experience. We may use information collected about you to create and manage your account, process your requests, and email you regarding your account status.</p>
        <h3 class="text-lg font-semibold text-gray-800 pt-2">Data Security</h3>
        <p>We use administrative, technical, and physical security measures to help protect your personal information. While we have taken reasonable steps to secure the personal information you provide to us, please be aware that despite our efforts, no security measures are perfect or impenetrable.</p>
        
    </div>
</template>

<template id="contact-content">
    <h2 class="text-2xl font-bold text-orange-600 mb-4">Contact Information</h2>
    <div class="space-y-4 text-gray-700 leading-relaxed">
        <p class="text-sm text-gray-500">Last updated: October 17, 2025</p>
        <p>If you have any questions, concerns, or need assistance, you can reach us through the following channels:</p>

        <h3 class="text-lg font-semibold text-gray-800 pt-2">Barangay Tañong Contact Details</h3>
        <ul class="list-disc list-inside space-y-2">
            <li><strong>Facebook:</strong> <a href="https://www.facebook.com/profile.php?id=61553549227340" target="_blank" class="text-blue-600 hover:underline">Barangay Tañong Council</a></li>
            <li><strong>Email:</strong> <a href="mailto:barangaytanongcouncil@gmail.com" class="text-blue-600 hover:underline">barangaytanongcouncil@gmail.com</a></li>
            <li><strong>Emergency Hotline:</strong> <a href="tel:0285253037" class="text-blue-600 hover:underline">02 8525 3037</a></li>
            <li><strong>Address:</strong> <a href="https://maps.google.com/?q=5+Lopez+Jaena+Street,+1803+Marikina+City,+Philippines" target="_blank" class="text-blue-600 hover:underline">5 Lopez Jaena Street, 1803 Marikina City, Philippines</a></li>
        </ul>

        <h3 class="text-lg font-semibold text-gray-800 pt-2">Marikina City Emergency Hotlines</h3>
        <ul class="list-disc list-inside space-y-2">
            <li><strong>Marikina Rescue 161 Hotline:</strong> 8-646-2436 to 38 </br> 8-646-0427 </br> 7-273-6563</li>
            <li><strong>Mobile Numbers:</strong>
                <ul class="list-disc list-inside ml-5 space-y-1">
                    <li>0917-584-2168 (Globe)</li>
                    <li>0917-804-6352 (Globe)</li>
                    <li>0928-559-3341 (Smart)</li>
                </ul>
            </li>
            <li><strong>Email:</strong> <a href="mailto:drrmo.marikinacity@gmail.com" class="text-blue-600 hover:underline">drrmo.marikinacity@gmail.com</a></li>
            <li><strong>Facebook Messenger:</strong> <a href="https://www.facebook.com/messages/t/349166318514092" target="_blank" class="text-blue-600 hover:underline">Reskyu Onesixone</a></li>
            <li><strong>Facebook Account:</strong> <a href="https://www.facebook.com/MarikinaRescue161" target="_blank" class="text-blue-600 hover:underline">Marikina City Rescue 161</a></li>
        </ul>
    </div>
</template>


<!-- 2. Generic Modal Structure -->
<div id="info-modal" class="fixed inset-0 z-[100] hidden bg-black bg-opacity-60 backdrop-blur-sm items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col modal-animate">
        <div class="flex items-center justify-between p-4 border-b">
            <h2 id="modal-title" class="text-xl font-semibold text-gray-800"></h2>
            <button id="modal-close-btn" class="text-gray-500 hover:text-red-500 text-3xl font-bold">&times;</button>
        </div>
        <div id="modal-content-body" class="p-6 overflow-y-auto">
            <!-- Content will be injected here -->
        </div>
    </div>
</div>

<!-- 3. Bottom Right Links -->
<div class="hidden md:flex fixed bottom-4 right-4 z-[90] gap-4">
    <button id="about-link" class="text-xs text-white hover:text-orange-500 hover:underline">About</button>
    <button id="privacy-link" class="text-xs text-white hover:text-orange-500 hover:underline">Privacy</button>
    <button id="contact-link" class="text-xs text-white hover:text-orange-500 hover:underline">Contact</button>
</div>

<!-- 4. JavaScript to Power the Modal -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('info-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContentBody = document.getElementById('modal-content-body');
        const closeBtn = document.getElementById('modal-close-btn');
        const aboutLink = document.getElementById('about-link');
        const privacyLink = document.getElementById('privacy-link');
        const contactLink = document.getElementById('contact-link');

        function openModal(title, templateId) {
            if (!modal || !modalTitle || !modalContentBody) return;

            const template = document.getElementById(templateId);
            if (!template) {
                modalContentBody.innerHTML = '<p class="text-center text-red-500">Content could not be found.</p>';
            } else {
                modalContentBody.innerHTML = template.innerHTML;
            }

            modalTitle.textContent = title;
            modal.classList.remove('hidden');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            if (!modal) return;
            modal.classList.add('hidden');
            modal.style.display = 'none';
            document.body.style.overflow = '';
        }

        if (aboutLink) aboutLink.addEventListener('click', () => openModal('About e-Serbisyong Tañong', 'about-content'));
        if (privacyLink) privacyLink.addEventListener('click', () => openModal('Privacy Policy', 'privacy-content'));
        if (contactLink) contactLink.addEventListener('click', () => openModal('Contact Information', 'contact-content'));
        if (closeBtn) closeBtn.addEventListener('click', closeModal);
        
        if (modal) {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
        }
        
        document.addEventListener('keydown', (e) => {
            if (e.key === "Escape" && !modal.classList.contains('hidden')) closeModal();
        });
    });
</script>

<!-- START: Mobile Bottom Navigation Bar -->
<nav id="bottom-nav" class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg flex justify-around items-center z-50 h-16">
    <a href="Home.html" class="bottom-nav-item flex flex-col items-center justify-center text-gray-500 hover:text-orange-500 w-full pt-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7m-9 2v8m4-8v8m5 0a2 2 0 002-2V7a2 2 0 00-2-2h-3.5a2 2 0 00-1.5.67"></path></svg>
        <span class="text-xs mt-1">Home</span>
    </a>
    <a href="Services.html" class="bottom-nav-item flex flex-col items-center justify-center text-gray-500 hover:text-orange-500 w-full pt-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg>
        <span class="text-xs mt-1">Services</span>
    </a>
    <a href="Appointments.html" class="bottom-nav-item flex flex-col items-center justify-center text-gray-500 hover:text-orange-500 w-full pt-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
        <span class="text-xs mt-1">Appointments</span>
    </a>
    <a href="Notifications.html" class="bottom-nav-item flex flex-col items-center justify-center text-gray-500 hover:text-orange-500 w-full pt-2 relative">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
        <span class="text-xs mt-1">Alerts</span>
        <!-- Notification badge for mobile -->
        <span id="notifBadgeMobile" class="absolute top-1 right-1/2 translate-x-4 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
    </a>
    <a href="Profile.html" class="bottom-nav-item flex flex-col items-center justify-center text-gray-500 hover:text-orange-500 w-full pt-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
        <span class="text-xs mt-1">Profile</span>
    </a>
</nav>

<script>
    // Script to highlight the active bottom navigation item
    document.addEventListener('DOMContentLoaded', function() {
        const bottomNavItems = document.querySelectorAll('.bottom-nav-item');
        // Use a more reliable way to get the current page name
        const currentPage = window.location.pathname.substring(window.location.pathname.lastIndexOf('/') + 1);

        bottomNavItems.forEach(item => {
            const itemPage = item.getAttribute('href');
            if (currentPage === itemPage) {
                item.classList.remove('text-gray-500');
                item.classList.add('text-orange-500'); // Highlight color
            }
        });
        
        // --- Mobile Notification Badge Logic ---
        // This makes the mobile badge mirror the sidebar badge
        const desktopBadge = document.getElementById('notifBadge');
        const mobileBadge = document.getElementById('notifBadgeMobile');

        if (desktopBadge && mobileBadge) {
            const observer = new MutationObserver(mutations => {
                mutations.forEach(mutation => {
                    if (mutation.type === 'attributes' || mutation.type === 'childList') {
                        const isHidden = desktopBadge.classList.contains('hidden');
                        const count = desktopBadge.textContent;
                        
                        mobileBadge.textContent = count;
                        if (isHidden || count === '0') {
                            mobileBadge.classList.add('hidden');
                        } else {
                            mobileBadge.classList.remove('hidden');
                        }
                    }
                });
            });

            observer.observe(desktopBadge, { attributes: true, childList: true, subtree: true });
        }
    });
</script>
</body>
</html>